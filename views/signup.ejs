<% layout('layouts/boilerplate') -%>

<body>
    <div class="row d-flex justify-content-center">
        <div class="col-10 col-lg-6 fade-in">
            <h2 class="mb-5">Sign up on MapMyStay</h2>
            <form method="post" action="/signup" class="needs-validation" novalidate id="signupForm">

                <div class="mb-4">
                    <label for="username" class="form-label">Username</label>
                    <input class="form-control" type="text" name="username" id="username"
                        placeholder="Enter Username" required>
                    <div class="invalid-feedback">
                        Please give a username
                    </div>
                </div>

                <div class="mb-4">
                    <label for="email" class="form-label">Email address</label>
                    <input class="form-control" type="email" name="email" id="email"
                        placeholder="Enter email address" required>
                    <div class="invalid-feedback">
                        Please give your email address
                    </div>
                </div>
                <div class="mb-4 ">
                    <label for="password" class="form-label">Password</label>
                    <input class="form-control" type="password" name="password" id="password"
                        placeholder="Enter new password" required>
                    <div class="invalid-feedback">
                        Please enter a new password
                    </div>
                </div>

                <div class="mb-4">
                    <button class="btn" id="signupBtn">
                        Sign up
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- GA4 event script -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const signupBtn = document.getElementById("signupBtn");
            if (signupBtn) {
                signupBtn.addEventListener("click", function (event) {
                    event.preventDefault();

                    const username = document.getElementById("username").value;
                    const email = document.getElementById("email").value;

                    // GA4 event
                    gtag('event', 'signup_attempt', {
                        username: username,
                        email: email
                    });

                    // Submit form after short delay
                    setTimeout(() => {
                        document.getElementById("signupForm").submit();
                    }, 300);
                });
            }
        });
    </script>

    <script src="/js/script.js"></script>
</body>
</html>
